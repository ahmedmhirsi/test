{% extends 'back_office/base.html.twig' %}

{% block title %}{{ user.prenom }} {{ user.nom }} - SmartNexus AI{% endblock %}

{% block breadcrumb %}
    <span class="text-[#9ca3af] material-symbols-outlined text-[16px]">chevron_right</span>
    <a href="{{ path('admin_user_index') }}" class="text-[#9ca3af] hover:text-white transition-colors">Utilisateurs</a>
    <span class="text-[#9ca3af] material-symbols-outlined text-[16px]">chevron_right</span>
    <span class="text-primary font-semibold">{{ user.prenom }} {{ user.nom }}</span>
{% endblock %}

{% block content %}
<div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
    <div class="flex items-center gap-4">
        {% if user.photo %}
            <div class="size-16 rounded-xl bg-cover bg-center" style="background-image: url('{{ user.photo }}');"></div>
        {% else %}
            <div class="size-16 rounded-xl bg-gradient-to-br from-primary to-electric flex items-center justify-center">
                <span class="text-navy font-bold text-2xl">{{ user.prenom|slice(0, 1)|upper }}{{ user.nom|slice(0, 1)|upper }}</span>
            </div>
        {% endif %}
        <div>
            <h1 class="text-3xl font-black tracking-tight text-[#D3C3B9] dark:text-white mb-1">
                {{ user.prenom }} {{ user.nom }}
            </h1>
            <p class="text-[#A79E9C] dark:text-[#9ca3af] text-base">{{ user.email }}</p>
        </div>
    </div>
    <div class="flex items-center gap-3">
        <a href="{{ path('admin_user_index') }}" class="flex items-center gap-2 px-4 py-2 rounded-lg border border-[#e5e7eb] dark:border-[#1f2128] text-[#A79E9C] hover:bg-gray-100 dark:hover:bg-[#161516] transition-colors">
            <span class="material-symbols-outlined text-[18px]">arrow_back</span>
            Retour
        </a>
        <a href="{{ path('admin_user_edit', {'id': user.id}) }}" class="flex items-center gap-2 px-4 py-2 bg-primary text-navy rounded-lg font-bold hover:bg-yellow-400 transition-colors">
            <span class="material-symbols-outlined text-[18px]">edit</span>
            Modifier
        </a>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Informations personnelles -->
    <div class="bg-white dark:bg-[#1a1d2d] rounded-xl border border-[#e5e7eb] dark:border-[#1f2128] shadow-sm p-6">
        <h3 class="text-lg font-bold text-[#D3C3B9] dark:text-white mb-4 flex items-center gap-2">
            <span class="material-symbols-outlined text-primary">person</span>
            Informations personnelles
        </h3>
        <div class="space-y-4">
            <div class="flex justify-between items-center py-3 border-b border-gray-100 dark:border-[#1f2128]">
                <span class="text-[#A79E9C]">ID</span>
                <span class="font-semibold text-[#D3C3B9] dark:text-white">{{ user.id }}</span>
            </div>
            <div class="flex justify-between items-center py-3 border-b border-gray-100 dark:border-[#1f2128]">
                <span class="text-[#A79E9C]">Prénom</span>
                <span class="font-semibold text-[#D3C3B9] dark:text-white">{{ user.prenom }}</span>
            </div>
            <div class="flex justify-between items-center py-3 border-b border-gray-100 dark:border-[#1f2128]">
                <span class="text-[#A79E9C]">Nom</span>
                <span class="font-semibold text-[#D3C3B9] dark:text-white">{{ user.nom }}</span>
            </div>
            <div class="flex justify-between items-center py-3 border-b border-gray-100 dark:border-[#1f2128]">
                <span class="text-[#A79E9C]">Email</span>
                <span class="font-semibold text-[#D3C3B9] dark:text-white">{{ user.email }}</span>
            </div>
            <div class="flex justify-between items-center py-3">
                <span class="text-[#A79E9C]">Téléphone</span>
                <span class="font-semibold text-[#D3C3B9] dark:text-white">{{ user.phoneNumber ?? 'Non renseigné' }}</span>
            </div>
        </div>
    </div>

    <!-- Compte -->
    <div class="bg-white dark:bg-[#1a1d2d] rounded-xl border border-[#e5e7eb] dark:border-[#1f2128] shadow-sm p-6">
        <h3 class="text-lg font-bold text-[#D3C3B9] dark:text-white mb-4 flex items-center gap-2">
            <span class="material-symbols-outlined text-primary">settings</span>
            Compte
        </h3>
        <div class="space-y-4">
            <div class="flex justify-between items-center py-3 border-b border-gray-100 dark:border-[#1f2128]">
                <span class="text-[#A79E9C]">Rôle</span>
                {% set roleLabel = 'Utilisateur' %}
                {% set roleColor = 'bg-gray-100 text-gray-700' %}
                {% if 'ROLE_ADMIN' in user.roles %}
                    {% set roleLabel = 'Admin' %}
                    {% set roleColor = 'bg-orange-100 text-orange-700' %}
                {% elseif 'ROLE_EMPLOYEE' in user.roles %}
                    {% set roleLabel = 'Employé' %}
                    {% set roleColor = 'bg-blue-100 text-blue-700' %}
                {% elseif 'ROLE_CLIENT' in user.roles %}
                    {% set roleLabel = 'Client' %}
                    {% set roleColor = 'bg-indigo-100 text-indigo-700' %}
                {% elseif 'ROLE_VISITEUR' in user.roles %}
                    {% set roleLabel = 'Visiteur' %}
                    {% set roleColor = 'bg-teal-100 text-teal-700' %}
                {% endif %}
                <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-bold {{ roleColor }}">{{ roleLabel }}</span>
            </div>
            <div class="flex justify-between items-center py-3 border-b border-gray-100 dark:border-[#1f2128]">
                <span class="text-[#A79E9C]">Statut</span>
                {% if user.isActive %}
                    <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-bold bg-green-100 text-green-700">
                        <span class="size-1.5 rounded-full bg-green-600"></span>
                        Actif
                    </span>
                {% else %}
                    <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-bold bg-red-100 text-red-700">
                        <span class="size-1.5 rounded-full bg-red-600"></span>
                        Inactif
                    </span>
                {% endif %}
            </div>
            <div class="flex justify-between items-center py-3 border-b border-gray-100 dark:border-[#1f2128]">
                <span class="text-[#A79E9C]">Email vérifié</span>
                {% if user.isVerified %}
                    <span class="text-green-600 font-semibold">Oui</span>
                {% else %}
                    <span class="text-red-600 font-semibold">Non</span>
                {% endif %}
            </div>
            <div class="flex justify-between items-center py-3 border-b border-gray-100 dark:border-[#1f2128]">
                <span class="text-[#A79E9C]">Créé le</span>
                <span class="font-semibold text-[#D3C3B9] dark:text-white">{{ user.createdAt ? user.createdAt|date('d/m/Y H:i') : '-' }}</span>
            </div>
            <div class="flex justify-between items-center py-3">
                <span class="text-[#A79E9C]">Dernière connexion</span>
                <span class="font-semibold text-[#D3C3B9] dark:text-white">{{ user.lastLoginAt ? user.lastLoginAt|date('d/m/Y H:i') : 'Jamais' }}</span>
            </div>
        </div>
    </div>
</div>

<!-- Bio & Expertise -->
{% if user.bio or user.expertise %}
<div class="mt-6 bg-white dark:bg-[#1a1d2d] rounded-xl border border-[#e5e7eb] dark:border-[#1f2128] shadow-sm p-6">
    <h3 class="text-lg font-bold text-[#D3C3B9] dark:text-white mb-4 flex items-center gap-2">
        <span class="material-symbols-outlined text-primary">description</span>
        Bio & Expertise
    </h3>
    {% if user.expertise %}
    <div class="mb-4">
        <span class="text-sm text-[#A79E9C] uppercase tracking-wider">Expertise</span>
        <p class="text-[#D3C3B9] dark:text-white mt-1">{{ user.expertise }}</p>
    </div>
    {% endif %}
    {% if user.bio %}
    <div>
        <span class="text-sm text-[#A79E9C] uppercase tracking-wider">Biographie</span>
        <p class="text-[#D3C3B9] dark:text-white mt-1">{{ user.bio }}</p>
    </div>
    {% endif %}
</div>
{% endif %}

<!-- Zone dangereuse -->
<div class="mt-6 bg-red-50 dark:bg-red-900/20 rounded-xl border border-red-200 dark:border-red-800 p-6">
    <h3 class="text-lg font-bold text-red-700 dark:text-red-400 mb-4">Zone dangereuse</h3>
    {{ include('admin/user/_delete_form.html.twig') }}
</div>
{% endblock %}
