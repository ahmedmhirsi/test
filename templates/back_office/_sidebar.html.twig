<!-- Logo Area -->
<div class="h-20 flex items-center gap-4 px-6 border-b border-white/5 bg-slate-900 relative overflow-hidden">
    <div class="relative flex size-10 items-center justify-center rounded-xl bg-nexus-primary text-white shadow-lg shadow-nexus-primary/20 group cursor-pointer transition-transform duration-500">
        <span class="material-symbols-outlined text-[24px]">dataset</span>
    </div>
    <div class="relative flex flex-col">
        <span class="text-lg font-black tracking-tight text-white leading-none">Smart<span class="text-slate-400">Nexus</span></span>
        <span class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mt-1">Enterprise AI</span>
    </div>
</div>

<!-- Navigation -->
<nav class="flex-1 overflow-y-auto no-scrollbar p-4 space-y-1">
    
    <!-- Dashboard -->
    <a href="{{ path('admin_dashboard') }}" class="group flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 relative overflow-hidden {% if app.request.get('_route') == 'admin_dashboard' %}bg-slate-800 text-white border border-white/5{% else %}text-slate-400 hover:text-white hover:bg-slate-800/50 border border-transparent{% endif %}">
        {% if app.request.get('_route') == 'admin_dashboard' %}
           <div class="absolute inset-y-0 left-0 w-1 bg-nexus-primary rounded-r-full"></div>
        {% endif %}
        <span class="material-symbols-outlined text-[20px] group-hover:text-nexus-primary transition-colors {% if app.request.get('_route') == 'admin_dashboard' %}text-nexus-primary{% endif %}">dashboard</span>
        <span class="font-bold text-sm">Dashboard</span>
    </a>

    <!-- Administration Support -->
    {% if is_granted('ROLE_ADMIN') %}
    <div class="pt-6 pb-2 px-4">
         <p class="text-[10px] font-black text-slate-600 uppercase tracking-[0.2em]">Admin Suite</p>
    </div>

    <div x-data="{ open: {{ app.request.get('_route') in ['admin_user_index', 'app_admin_document_index', 'app_admin_audit_log_index'] ? 'true' : 'false' }} }">
        <button @click="open = !open" class="w-full flex items-center justify-between px-4 py-2 text-xs font-bold text-slate-400 hover:text-white transition-colors group">
            <span class="flex items-center gap-2">
                 <div class="size-1.5 rounded-full bg-slate-600 group-hover:bg-nexus-primary transition-colors"></div>
                 Administration
            </span>
            <span class="material-symbols-outlined text-[16px] transition-transform duration-300 text-slate-600 group-hover:text-white" :class="open ? 'rotate-180' : ''">expand_more</span>
        </button>
        <div x-show="open" x-transition.opacity class="space-y-1 mt-1 pl-2 border-l border-white/5 ml-4">
            {% for item in [
                {'route': 'admin_user_index', 'icon': 'group', 'label': 'Utilisateurs'},
                {'route': 'app_admin_document_index', 'icon': 'description', 'label': 'Documents RAG'}
            ] %}
            <a href="{{ path(item.route) }}" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors relative group/link {% if app.request.get('_route') starts with item.route %}text-white bg-slate-800{% else %}text-slate-500 hover:text-white hover:bg-slate-800/50{% endif %}">
                 <span class="material-symbols-outlined text-[18px] {% if app.request.get('_route') starts with item.route %}text-nexus-primary{% else %}group-hover/link:text-nexus-primary transition-colors{% endif %}">{{ item.icon }}</span>
                <span>{{ item.label }}</span>
            </a>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Project Management -->
    {% if is_granted('ROLE_PROJECT_MANAGER') %}
    <div class="pt-6 pb-2 px-4">
         <p class="text-[10px] font-black text-slate-600 uppercase tracking-[0.2em]">Gestion Projets</p>
    </div>
    
     <div x-data="{ open: {{ app.request.get('_route') in ['app_projet_index', 'app_sprint_index', 'app_tache_index', 'app_jalon_index', 'app_kanban_index'] ? 'true' : 'false' }} }">
         <button @click="open = !open" class="w-full flex items-center justify-between px-4 py-2 text-xs font-bold text-slate-400 hover:text-white transition-colors group">
            <span class="flex items-center gap-2">
                 <div class="size-1.5 rounded-full bg-slate-600 group-hover:bg-nexus-accent transition-colors"></div>
                 Project Command
            </span>
            <span class="material-symbols-outlined text-[16px] transition-transform duration-300 text-slate-600 group-hover:text-white" :class="open ? 'rotate-180' : ''">expand_more</span>
        </button>
        <div x-show="open" x-transition.opacity class="space-y-1 mt-1 pl-2 border-l border-white/5 ml-4">
             {% for item in [
                {'route': 'app_projet_index', 'icon': 'folder_managed', 'label': 'Projets'},
                {'route': 'app_sprint_index', 'icon': 'timer', 'label': 'Sprints'},
                {'route': 'app_tache_index', 'icon': 'task_alt', 'label': 'Tâches'},
                {'route': 'app_jalon_index', 'icon': 'flag', 'label': 'Jalons'},
                {'route': 'app_kanban_index', 'icon': 'view_kanban', 'label': 'Kanban Board'}
            ] %}
             <a href="{{ path(item.route) }}" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors relative group/link {% if app.request.get('_route') starts with item.route %}text-white bg-slate-800{% else %}text-slate-500 hover:text-white hover:bg-slate-800/50{% endif %}">
                 <span class="material-symbols-outlined text-[18px] {% if app.request.get('_route') starts with item.route %}text-nexus-accent{% else %}group-hover/link:text-nexus-accent transition-colors{% endif %}">{{ item.icon }}</span>
                <span>{{ item.label }}</span>
            </a>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Collaboration & Comms -->
    <div class="pt-6 pb-2 px-4">
         <p class="text-[10px] font-black text-slate-600 uppercase tracking-[0.2em]">Collaboration</p>
    </div>

    <div x-data="{ open: {{ app.request.get('_route') in ['app_collaboration_dashboard', 'app_channel_index', 'app_meeting_index', 'app_poll_index', 'app_recording_index', 'app_whiteboard_index'] ? 'true' : 'false' }} }">
         <button @click="open = !open" class="w-full flex items-center justify-between px-4 py-2 text-xs font-bold text-slate-400 hover:text-white transition-colors group">
            <span class="flex items-center gap-2">
                 <div class="size-1.5 rounded-full bg-slate-600 group-hover:bg-emerald-400 transition-colors"></div>
                 Communication
            </span>
            <span class="material-symbols-outlined text-[16px] transition-transform duration-300 text-slate-600 group-hover:text-white" :class="open ? 'rotate-180' : ''">expand_more</span>
        </button>
        <div x-show="open" x-transition.opacity class="space-y-1 mt-1 pl-2 border-l border-white/5 ml-4">
             <a href="{{ path('app_collaboration_dashboard') }}" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors relative group/link {% if app.request.get('_route') == 'app_collaboration_dashboard' %}text-white bg-slate-800{% else %}text-slate-500 hover:text-white hover:bg-slate-800/50{% endif %}">
                 <span class="material-symbols-outlined text-[18px] {% if app.request.get('_route') == 'app_collaboration_dashboard' %}text-emerald-400{% else %}group-hover/link:text-emerald-400 transition-colors{% endif %}">hub</span>
                <span>Hub Central</span>
            </a>
             {% for item in [
                {'route': 'app_channel_index', 'icon': 'forum', 'label': 'Channels'},
                {'route': 'app_meeting_index', 'icon': 'video_call', 'label': 'Meetings'},
                {'route': 'app_poll_index', 'icon': 'poll', 'label': 'Sondages'},
                {'route': 'app_recording_index', 'icon': 'video_library', 'label': 'Replays'},
                {'route': 'app_whiteboard_index', 'icon': 'draw', 'label': 'Whiteboard'},
                {'route': 'app_admin_audit_log_index', 'icon': 'history', 'label': 'Audit Logs'}
            ] %}
            {% if not is_granted('ROLE_ADMIN') or item.route in ['app_channel_index', 'app_admin_audit_log_index'] %}
             <a href="{{ path(item.route) }}" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors relative group/link {% if app.request.get('_route') starts with item.route %}text-white bg-slate-800{% else %}text-slate-500 hover:text-white hover:bg-slate-800/50{% endif %}">
                 <span class="material-symbols-outlined text-[18px] {% if app.request.get('_route') starts with item.route %}text-emerald-400{% else %}group-hover/link:text-emerald-400 transition-colors{% endif %}">{{ item.icon }}</span>
                <span>{{ item.label }}</span>
            </a>
            {% endif %}
            {% endfor %}
        </div>
    </div>

    <!-- Marketing -->
    <div x-data="{ open: {{ app.request.get('_route') starts with 'app_marketing' ? 'true' : 'false' }} }">
         <button @click="open = !open" class="w-full flex items-center justify-between px-4 py-2 mt-4 text-xs font-bold text-slate-400 hover:text-white transition-colors group">
            <span class="flex items-center gap-2">
                 <div class="size-1.5 rounded-full bg-slate-600 group-hover:bg-rose-500 transition-colors"></div>
                 Marketing Suite
            </span>
            <span class="material-symbols-outlined text-[16px] transition-transform duration-300 text-slate-600 group-hover:text-white" :class="open ? 'rotate-180' : ''">expand_more</span>
        </button>
        <div x-show="open" x-transition.opacity class="space-y-1 mt-1 pl-2 border-l border-white/5 ml-4">
             {% for item in [
                {'route': 'app_marketing_dashboard', 'icon': 'campaign', 'label': 'Dashboard'},
                {'route': 'app_marketing_campaigns', 'icon': 'rocket_launch', 'label': 'Campagnes'},
                {'route': 'app_marketing_leads', 'icon': 'contacts', 'label': 'Leads'}
            ] %}
             <a href="{{ path(item.route) }}" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors relative group/link {% if app.request.get('_route') starts with item.route %}text-white bg-slate-800{% else %}text-slate-500 hover:text-white hover:bg-slate-800/50{% endif %}">
                 <span class="material-symbols-outlined text-[18px] {% if app.request.get('_route') starts with item.route %}text-rose-500{% else %}group-hover/link:text-rose-500 transition-colors{% endif %}">{{ item.icon }}</span>
                <span>{{ item.label }}</span>
            </a>
            {% endfor %}
            {% if is_granted('ROLE_ADMIN') %}
                 <a href="{{ path('app_marketing_channels') }}" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors relative group/link {% if app.request.get('_route') starts with 'app_marketing_channels' %}text-white bg-slate-800{% else %}text-slate-500 hover:text-white hover:bg-slate-800/50{% endif %}">
                     <span class="material-symbols-outlined text-[18px] {% if app.request.get('_route') starts with 'app_marketing_channels' %}text-rose-500{% else %}group-hover/link:text-rose-500 transition-colors{% endif %}">alt_route</span>
                    <span>Canaux</span>
                </a>
                 <a href="{{ path('app_marketing_analytics') }}" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors relative group/link {% if app.request.get('_route') starts with 'app_marketing_analytics' %}text-white bg-slate-800{% else %}text-slate-500 hover:text-white hover:bg-slate-800/50{% endif %}">
                     <span class="material-symbols-outlined text-[18px] {% if app.request.get('_route') starts with 'app_marketing_analytics' %}text-rose-500{% else %}group-hover/link:text-rose-500 transition-colors{% endif %}">insights</span>
                    <span>Analytics</span>
                </a>
            {% endif %}
        </div>
    </div>

     <!-- RH Section -->
    <div x-data="{ open: {{ app.request.get('_route') in ['app_offre_emploi_index', 'app_candidature_index', 'app_formation_index'] ? 'true' : 'false' }} }">
         <button @click="open = !open" class="w-full flex items-center justify-between px-4 py-2 mt-4 text-xs font-bold text-slate-400 hover:text-white transition-colors group">
            <span class="flex items-center gap-2">
                 <div class="size-1.5 rounded-full bg-slate-600 group-hover:bg-amber-500 transition-colors"></div>
                 Recrutement
            </span>
            <span class="material-symbols-outlined text-[16px] transition-transform duration-300 text-slate-600 group-hover:text-white" :class="open ? 'rotate-180' : ''">expand_more</span>
        </button>
        <div x-show="open" x-transition.opacity class="space-y-1 mt-1 pl-2 border-l border-white/5 ml-4">
             {% for item in [
                {'route': 'app_offre_emploi_index', 'icon': 'work', 'label': 'Offres'},
                {'route': 'app_candidature_index', 'icon': 'badge', 'label': 'Candidatures'},
                {'route': 'app_formation_index', 'icon': 'school', 'label': 'Formations'}
            ] %}
             <a href="{{ path(item.route) }}" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors relative group/link {% if app.request.get('_route') starts with item.route %}text-white bg-slate-800{% else %}text-slate-500 hover:text-white hover:bg-slate-800/50{% endif %}">
                 <span class="material-symbols-outlined text-[18px] {% if app.request.get('_route') starts with item.route %}text-amber-500{% else %}group-hover/link:text-amber-500 transition-colors{% endif %}">{{ item.icon }}</span>
                <span>{{ item.label }}</span>
            </a>
            {% endfor %}
        </div>
    </div>

     <!-- Support -->
    <div x-data="{ open: {{ app.request.get('_route') starts with 'back_reclamation' ? 'true' : 'false' }} }">
         <button @click="open = !open" class="w-full flex items-center justify-between px-4 py-2 mt-4 text-xs font-bold text-slate-400 hover:text-white transition-colors group">
            <span class="flex items-center gap-2">
                 <div class="size-1.5 rounded-full bg-slate-600 group-hover:bg-slate-400 transition-colors"></div>
                 Support
            </span>
            <span class="material-symbols-outlined text-[16px] transition-transform duration-300 text-slate-600 group-hover:text-white" :class="open ? 'rotate-180' : ''">expand_more</span>
        </button>
        <div x-show="open" x-transition.opacity class="space-y-1 mt-1 pl-2 border-l border-white/5 ml-4">
             <a href="{{ path('back_reclamation_index') }}" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors relative group/link {% if app.request.get('_route') starts with 'back_reclamation' %}text-white bg-slate-800{% else %}text-slate-500 hover:text-white hover:bg-slate-800/50{% endif %}">
                 <span class="material-symbols-outlined text-[18px] {% if app.request.get('_route') starts with 'back_reclamation' %}text-white{% else %}group-hover/link:text-white transition-colors{% endif %}">confirmation_number</span>
                <span>Réclamations</span>
            </a>
        </div>
    </div>

    <div class="h-10"></div> <!-- Spacer -->
</nav>

<!-- Bottom Profile Card -->
<div class="p-4 bg-slate-900 border-t border-white/5">
    <div class="relative group cursor-pointer overflow-hidden rounded-xl bg-slate-800/50 hover:bg-slate-800 transition-all duration-300 border border-white/5 p-3 flex items-center gap-3">
        
        <div class="relative size-10 rounded-full bg-slate-700 flex items-center justify-center text-white font-bold border border-white/10 group-hover:border-nexus-primary transition-all">
            {{ app.user.prenom|first|upper }}{{ app.user.nom|first|upper }}
        </div>
        
        <div class="relative flex-1 min-w-0">
            <h4 class="text-sm font-bold text-white truncate group-hover:text-nexus-primary transition-colors">{{ app.user.prenom }} {{ app.user.nom }}</h4>
            <p class="text-xs text-slate-500 truncate">
                 {% if 'ROLE_ADMIN' in app.user.roles %}Administrateur
                 {% elseif 'ROLE_PROJECT_MANAGER' in app.user.roles %}Manager
                 {% else %}Utilisateur{% endif %}
            </p>
        </div>

        <a href="{{ path('app_logout') }}" class="relative p-2 rounded-lg text-slate-500 hover:text-rose-400 hover:bg-rose-500/10 transition-colors" title="Déconnexion">
            <span class="material-symbols-outlined text-[20px]">logout</span>
        </a>
    </div>
</div>
