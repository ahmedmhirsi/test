<!DOCTYPE html>
<html class="light" lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}SmartNexusAI - Collaboration{% endblock %}</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100..900&family=Open+Sans:wght@300..800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet">
    
    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#536DFE",
                        "navy": "#1A237E",
                        "gold": "#FFC107",
                        "background-light": "#F5F7FA",
                        "background-dark": "#0f1223",
                    },
                    fontFamily: {
                        "sans": ["Open Sans", "sans-serif"],
                        "display": ["Montserrat", "sans-serif"]
                    },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px" },
                },
            },
        }
    </script>
    
    <style type="text/tailwindcss">
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent; 
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #374151;
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        /* Sidebar Link Active State */
        .nav-link.active {
            @apply bg-primary/10 text-primary dark:bg-primary/20;
        }
    </style>
    
    {% block stylesheets %}{% endblock %}
</head>
<body class="bg-background-light dark:bg-background-dark font-sans text-navy dark:text-gray-100 h-screen flex overflow-hidden">
    
    <!-- Sidebar (Left) -->
    {{ include('_sidebar.html.twig') }}

    <!-- Main Content Wrapper -->
    <div class="flex-1 flex flex-col h-screen overflow-hidden relative">
        
        <!-- Mobile Header (Visible on small screens only) -->
        <header class="lg:hidden flex shrink-0 items-center justify-between border-b border-gray-200 dark:border-b-[#1f2937] bg-white dark:bg-[#1a1d2d] px-4 py-3 h-16 z-20">
             <div class="flex items-center gap-3 text-navy">
                <div class="size-8 flex items-center justify-center bg-primary/10 rounded-lg">
                    <span class="material-symbols-outlined text-primary text-[24px]">dataset</span>
                </div>
                <h2 class="text-navy dark:text-white text-lg font-display font-bold leading-tight">SmartNexus</h2>
            </div>
            <button class="p-2 text-gray-500">
                <span class="material-symbols-outlined">menu</span>
            </button>
        </header>

        <!-- Top Bar (Desktop) - Optional search/notifs if needed outside sidebar -->
        <header class="hidden lg:flex shrink-0 items-center justify-between border-b border-gray-200 dark:border-b-[#1f2937] bg-white dark:bg-[#1a1d2d] px-6 py-3 h-16 z-10">
            <!-- Search -->
            <label class="flex flex-col min-w-40 !h-10 max-w-64">
                <div class="flex w-full flex-1 items-stretch rounded-lg h-full">
                    <div class="text-gray-400 dark:text-gray-400 flex border-none bg-gray-100 dark:bg-[#2a2e3f] items-center justify-center pl-4 rounded-l-lg border-r-0">
                        <span class="material-symbols-outlined text-[20px]">search</span>
                    </div>
                    <input class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-navy dark:text-white focus:outline-0 focus:ring-0 border-none bg-gray-100 dark:bg-[#2a2e3f] focus:border-none h-full placeholder:text-gray-400 px-4 rounded-l-none border-l-0 pl-2 text-sm font-normal leading-normal" placeholder="Search..." value="">
                </div>
            </label>

            <!-- Actions -->
            <div class="flex items-center gap-4">
                 <button class="text-gray-500 hover:text-primary dark:text-gray-400">
                    <span class="material-symbols-outlined">help</span>
                </button>
                <div class="h-6 w-px bg-gray-200 dark:bg-gray-700"></div>
                <button class="flex items-center justify-center size-10 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors relative">
                    <span class="material-symbols-outlined text-gray-500 dark:text-gray-400">notifications</span>
                    <span class="absolute top-2 right-2 size-2 bg-gold rounded-full border-2 border-white dark:border-[#1a1d2d]"></span>
                </button>
            </div>
        </header>

        <!-- Main Content Area -->
        <div class="flex-1 overflow-x-hidden overflow-y-auto">
            <!-- Flash Messages -->
            {% for label, messages in app.flashes %}
                {% for message in messages %}
                    <div class="mx-6 mt-4 p-4 rounded-lg {% if label == 'success' %}bg-green-50 text-green-800 border border-green-200{% elseif label == 'error' %}bg-red-50 text-red-800 border border-red-200{% else %}bg-blue-50 text-blue-800 border border-blue-200{% endif %}">
                        <div class="flex items-center gap-2">
                            <span class="material-symbols-outlined">{% if label == 'success' %}check_circle{% elseif label == 'error' %}error{% else %}info{% endif %}</span>
                            <span class="font-semibold">{{ message }}</span>
                        </div>
                    </div>
                {% endfor %}
            {% endfor %}

            {% block body %}{% endblock %}
        </div>
    </div>

    {% block javascripts %}
        {% block importmap %}{{ importmap('app') }}{% endblock %}
    {% endblock %}

    <script>
        // Heartbeat to update online status every 30 seconds
        setInterval(() => {
            fetch('/user/heartbeat', { method: 'POST' });
        }, 30000); // 30 seconds
    </script>
</body>
</html>
