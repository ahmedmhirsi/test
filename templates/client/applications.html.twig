{% extends 'front_office/base.html.twig' %}

{% block title %}Mes Candidatures - SmartNexus AI{% endblock %}

{% block sidebar_nav %}
    <a href="{{ path('app_client_dashboard') }}" class="flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-bold text-[#5e658d] dark:text-[#9ca3af] hover:bg-gray-100 dark:hover:bg-[#252836] transition-colors">
        <span class="material-symbols-outlined text-[20px]">dashboard</span>
        <span>Tableau de bord</span>
    </a>
    <a href="{{ path('app_client_explore') }}" class="flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-bold text-[#5e658d] dark:text-[#9ca3af] hover:bg-gray-100 dark:hover:bg-[#252836] transition-colors">
        <span class="material-symbols-outlined text-[20px]">explore</span>
        <span>Explorer</span>
    </a>
    <a href="{{ path('app_client_offers') }}" class="flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-bold text-[#5e658d] dark:text-[#9ca3af] hover:bg-gray-100 dark:hover:bg-[#252836] transition-colors">
        <span class="material-symbols-outlined text-[20px]">work</span>
        <span>Mes Offres</span>
    </a>
    <a href="{{ path('app_client_applications') }}" class="flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-bold bg-primary/10 text-primary transition-colors">
        <span class="material-symbols-outlined text-[20px]">group</span>
        <span>Candidatures</span>
    </a>
    <a href="{{ path('front_reclamation_index') }}" class="flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-bold text-[#5e658d] dark:text-[#9ca3af] hover:bg-gray-100 dark:hover:bg-[#252836] transition-colors">
        <span class="material-symbols-outlined text-[20px]">list_alt</span>
        <span>Réclamations</span>
    </a>
    <a href="{{ path('app_client_projets') }}" class="flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-bold text-[#5e658d] dark:text-[#9ca3af] hover:bg-gray-100 dark:hover:bg-[#252836] transition-colors">
        <span class="material-symbols-outlined text-[20px]">folder_open</span>
        <span>Projets</span>
    </a>
    <a href="{{ path('app_client_jalons') }}" class="flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-bold text-[#5e658d] dark:text-[#9ca3af] hover:bg-gray-100 dark:hover:bg-[#252836] transition-colors">
        <span class="material-symbols-outlined text-[20px]">flag</span>
        <span>Jalons</span>
    </a>
    <a href="{{ path('app_client_progress') }}" class="flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-bold text-[#5e658d] dark:text-[#9ca3af] hover:bg-gray-100 dark:hover:bg-[#252836] transition-colors">
        <span class="material-symbols-outlined text-[20px]">trending_up</span>
        <span>Avancement</span>
    </a>
    <a href="{{ path('app_profile') }}" class="flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-bold text-[#5e658d] dark:text-[#9ca3af] hover:bg-gray-100 dark:hover:bg-[#252836] transition-colors">
        <span class="material-symbols-outlined text-[20px]">person</span>
        <span>Mon Profil</span>
    </a>
{% endblock %}

{% block breadcrumb %}
    <span class="text-[#9ca3af] material-symbols-outlined text-[16px]">chevron_right</span>
    <span class="text-primary font-semibold">Mes Candidatures</span>
{% endblock %}

{% block content %}
<div class="space-y-6">
    <div>
        <h1 class="text-3xl font-black dark:text-white">Suivi des Candidatures</h1>
        <p class="text-[#5e658d] dark:text-[#9ca3af]">Gérez l'état de vos postulations en temps réel</p>
    </div>

    <div class="bg-white dark:bg-[#1a1d2d] rounded-2xl border border-[#e5e7eb] dark:border-[#2d3142] shadow-sm overflow-hidden">
        <div class="overflow-x-auto">
            <table class="w-full text-left">
                <thead class="bg-gray-50 dark:bg-[#252836] border-b border-[#e5e7eb] dark:border-[#2d3142]">
                    <tr>
                        <th class="px-6 py-4 text-xs font-black text-[#5e658d] dark:text-[#9ca3af] uppercase tracking-wider">Offre / Poste</th>
                        <th class="px-6 py-4 text-xs font-black text-[#5e658d] dark:text-[#9ca3af] uppercase tracking-wider">Date de dépôt</th>
                        <th class="px-6 py-4 text-xs font-black text-[#5e658d] dark:text-[#9ca3af] uppercase tracking-wider">Score IA</th>
                        <th class="px-6 py-4 text-xs font-black text-[#5e658d] dark:text-[#9ca3af] uppercase tracking-wider">Statut</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-[#e5e7eb] dark:divide-[#2d3142]">
                    {% for application in applications %}
                        <tr class="hover:bg-gray-50 dark:hover:bg-[#252836]/30 transition-colors group">
                            <td class="px-6 py-4">
                                <div class="flex items-center gap-3">
                                    <div class="size-10 rounded-lg bg-primary/10 flex items-center justify-center text-primary font-bold">
                                        <span class="material-symbols-outlined text-[20px]">work</span>
                                    </div>
                                    <div>
                                        <p class="font-bold text-[#101218] dark:text-white group-hover:text-primary transition-colors">{{ application.offreEmploi.poste }}</p>
                                        <p class="text-xs text-[#5e658d]">{{ application.offreEmploi.typeContrat }}</p>
                                    </div>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <span class="text-sm text-gray-600 dark:text-gray-400 font-medium">{{ application.dateDepot|date('d/m/Y') }}</span>
                            </td>
                            <td class="px-6 py-4">
                                {% if application.scoreMatchingIA %}
                                    <div class="flex items-center gap-3">
                                        <div class="w-20 h-1.5 bg-gray-100 dark:bg-gray-800 rounded-full overflow-hidden">
                                            <div class="h-full bg-primary rounded-full" style="width: {{ application.scoreMatchingIA }}%"></div>
                                        </div>
                                        <span class="text-xs font-black text-primary">{{ application.scoreMatchingIA|number_format(0) }}%</span>
                                    </div>
                                {% else %}
                                    <span class="text-xs text-gray-400 italic">En attente</span>
                                {% endif %}
                            </td>
                            <td class="px-6 py-4">
                                <span class="px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-wider
                                    {% if application.statut == 'Accepté' %}bg-green-100 text-green-700
                                    {% elseif application.statut == 'Refusé' %}bg-red-100 text-red-700
                                    {% elseif application.statut == 'Entretien' %}bg-blue-100 text-blue-700
                                    {% else %}bg-amber-100 text-amber-700{% endif %}">
                                    {{ application.statut }}
                                </span>
                            </td>
                        </tr>
                    {% else %}
                        <tr>
                            <td colspan="4" class="px-6 py-12 text-center text-gray-500 italic">
                                Aucune candidature à afficher.
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
