{% extends 'client/base_client.html.twig' %}

{% block title %}Dashboard Explorer - SmartNexus{% endblock %}

{% block stylesheets %}
<style>
    :root {
        --dash-blue: #2563eb;
        --dash-bg: #f8fafc;
        --dash-card-shadow: 0 10px 30px -12px rgba(0, 0, 0, 0.04);
    }

    .dashboard-header {
        background: white;
        margin: -2rem -2rem 2rem -2rem;
        padding: 2rem;
        border-bottom: 1px solid #e2e8f0;
    }

    .sub-nav-item {
        position: relative;
        transition: all 0.3s ease;
    }

    .sub-nav-item.active::after {
        content: '';
        position: absolute;
        bottom: -2rem;
        left: 0;
        width: 100%;
        height: 4px;
        background: var(--dash-blue);
        border-radius: 4px 4px 0 0;
    }

    .stat-card {
        background: white;
        border-radius: 1.5rem;
        padding: 1.5rem;
        box-shadow: var(--dash-card-shadow);
        border: 1px solid #f1f5f9;
        transition: transform 0.3s ease;
    }

    .stat-card:hover {
        transform: translateY(-4px);
    }

    .progress-bar-glow {
        box-shadow: 0 0 12px rgba(37, 99, 235, 0.2);
    }

    .tab-content {
        display: none;
        animation: fadeIn 0.4s ease-out forwards;
    }

    .tab-content.active {
        display: block;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>
{% endblock %}

{% block body %}
    <!-- Dashboard Top Breadcrumbs & Title -->
    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8">
        <div>
            <div class="flex items-center gap-2 text-xs font-bold text-slate-400 uppercase tracking-widest mb-3">
                <a href="#" class="hover:text-brand-600">Explorer</a>
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M9 5l7 7-7 7" stroke-width="3"></path></svg>
                <span class="text-slate-600">Vue Supervision</span>
            </div>
            <h1 class="text-4xl font-black text-slate-900 tracking-tight">Vue <span class="text-brand-600">Supervision</span></h1>
        </div>
        <div class="flex items-center gap-3">
             <button class="px-5 py-2.5 bg-white border border-slate-200 rounded-xl text-xs font-black text-slate-600 hover:bg-slate-50 transition-all flex items-center gap-2 shadow-sm">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2-8H7a2 2 0 00-2 2v14a2 2 0 002 2h10a2 2 0 002-2V5a2 2 0 00-2-2z"></path></svg>
                Export PDF
             </button>
             <button class="px-5 py-2.5 bg-brand-600 text-white rounded-xl text-xs font-black hover:bg-brand-700 transition-all flex items-center gap-2 shadow-lg shadow-brand-100">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>
                Vue Réelle
             </button>
        </div>
    </div>

    <!-- Analytics Cards Row -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
        <!-- Velocity Style Card -->
        <div class="stat-card">
            <div class="flex items-center justify-between mb-4">
                <span class="text-[11px] font-black text-slate-400 uppercase tracking-widest">Couverture Marché</span>
                <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center text-brand-600">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>
                </div>
            </div>
            <div class="flex items-baseline gap-2 mb-2">
                <span class="text-3xl font-black text-slate-900">{{ offers|length + formations|length }}</span>
                <span class="text-sm font-bold text-slate-400">éléments</span>
            </div>
            <div class="h-16 w-full flex items-end gap-1.5 mt-4">
                <div class="flex-1 bg-brand-100 rounded-t-lg transition-all hover:bg-brand-600" style="height: 40%"></div>
                <div class="flex-1 bg-brand-600 rounded-t-lg" style="height: 75%"></div>
                <div class="flex-1 bg-brand-100 rounded-t-lg transition-all hover:bg-brand-600" style="height: 55%"></div>
                <div class="flex-1 bg-brand-600 rounded-t-lg" style="height: 90%"></div>
                <div class="flex-1 bg-brand-100 rounded-t-lg transition-all hover:bg-brand-600" style="height: 60%"></div>
            </div>
            <div class="mt-4 flex justify-between items-center text-[10px] font-bold text-slate-400">
                <span>VOL. ACTUEL</span>
                <span class="text-brand-600">+12% vs mois dernier</span>
            </div>
        </div>

        <!-- Progress Style Card -->
        <div class="stat-card">
             <div class="flex items-center justify-between mb-4">
                <span class="text-[11px] font-black text-slate-400 uppercase tracking-widest">Progression Candidatures</span>
                <div class="w-8 h-8 rounded-lg bg-emerald-50 flex items-center justify-center text-emerald-600">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                </div>
            </div>
            <div class="flex items-baseline gap-2 mb-6">
                <span class="text-3xl font-black text-slate-900">85<span class="text-lg text-slate-400">/100</span></span>
            </div>
            <div class="relative pt-1">
                <div class="overflow-hidden h-2.5 mb-4 text-xs flex rounded-full bg-slate-100">
                    <div style="width:85%" class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-brand-600 progress-bar-glow transition-all duration-1000"></div>
                </div>
            </div>
            <div class="mt-4 flex justify-between items-center text-[10px] font-bold text-slate-400">
                <span>OBJECTIF SMARTER</span>
                <span class="px-2 py-0.5 bg-brand-50 text-brand-600 rounded-md">Excellent</span>
            </div>
        </div>

        <!-- AI Prediction Style Card -->
        <div class="stat-card relative overflow-hidden group">
            <div class="absolute -top-10 -right-10 w-40 h-40 bg-brand-50 rounded-full blur-3xl opacity-50 transition-transform group-hover:scale-150"></div>
            <div class="flex items-center justify-between mb-4">
                <span class="text-[11px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2">
                    <svg class="w-4 h-4 text-brand-500" fill="currentColor" viewBox="0 0 20 20"><path d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z"></path></svg>
                    Prédiction IA
                </span>
            </div>
            <div class="flex items-baseline gap-2 mb-2">
                <span class="text-5xl font-black text-brand-600">92%</span>
            </div>
            <p class="text-xs font-bold text-slate-500 mb-6 leading-relaxed">
                Score de matching optimal détecté pour <span class="text-slate-900">votre profil technique</span>.
            </p>
            <div class="mt-auto">
                <div class="h-1.5 w-full bg-slate-100 rounded-full overflow-hidden">
                    <div class="h-full bg-brand-600 rounded-full" style="width: 92%"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Tabs Selection -->
    <div class="dashboard-header mb-8 bg-white ring-1 ring-slate-200 shadow-sm rounded-3xl">
        <div class="flex items-center gap-10">
            <button onclick="switchDashTab('offers')" id="tab-offers" class="dash-tab sub-nav-item active text-sm font-black text-slate-900 py-2 flex items-center gap-3 group">
                <div class="w-8 h-8 rounded-lg bg-brand-50 flex items-center justify-center text-brand-600 group-hover:bg-brand-600 group-hover:text-white transition-all">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg>
                </div>
                Offres d'emploi
            </button>
            <button onclick="switchDashTab('formations')" id="tab-formations" class="dash-tab sub-nav-item text-sm font-black text-slate-500 py-2 flex items-center gap-3 group hover:text-slate-900 transition-colors">
                 <div class="w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center text-slate-500 group-hover:bg-brand-600 group-hover:text-white transition-all">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
                </div>
                Formations
            </button>
        </div>
    </div>

    <!-- Content Sections -->
    <div id="content-offers" class="tab-content active transition-all">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for offer in offers %}
            <div class="bg-white rounded-3xl p-6 border border-slate-200 shadow-sm hover:shadow-xl hover:border-brand-300 transition-all group">
                <div class="flex justify-between items-start mb-6">
                    <span class="px-2.5 py-1 bg-brand-50 text-brand-600 rounded-lg text-[9px] font-black uppercase tracking-widest border border-brand-100">Poste Ouvert</span>
                    <button class="text-slate-300 hover:text-brand-600 transition-colors">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg>
                    </button>
                </div>
                <h3 class="text-lg font-black text-slate-900 mb-2 group-hover:text-brand-600 transition-colors">{{ offer.poste }}</h3>
                <p class="text-[13px] text-slate-500 line-clamp-2 mb-6 font-medium leading-relaxed">{{ offer.description }}</p>
                <div class="flex items-center gap-2 mb-6">
                    <span class="px-3 py-1 bg-slate-100 text-slate-600 rounded-lg text-[10px] font-bold">#{{ offer.typeContrat }}</span>
                    {% if offer.salaireMin %}
                        <span class="px-3 py-1 bg-brand-50 text-brand-600 rounded-lg text-[10px] font-bold">{{ (offer.salaireMin / 1000)|number_format(0) }}k - {{ (offer.salaireMax / 1000)|number_format(0) }}k DT</span>
                    {% endif %}
                </div>
                <a href="{{ path('app_offre_emploi_public_show', {'id': offer.id}) }}" class="w-full flex items-center justify-center py-3 bg-brand-600 text-white rounded-xl text-xs font-black hover:bg-brand-700 transition-all shadow-lg shadow-brand-100/50">
                    Consulter l'offre
                </a>
            </div>
            {% endfor %}
        </div>
    </div>

    <div id="content-formations" class="tab-content transition-all">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for formation in formations %}
            <div class="bg-white rounded-3xl p-6 border border-slate-200 shadow-sm hover:shadow-xl hover:border-indigo-300 transition-all group">
                <div class="flex justify-between items-start mb-6">
                    <span class="px-2.5 py-1 bg-indigo-50 text-indigo-600 rounded-lg text-[9px] font-black uppercase tracking-widest border border-indigo-100">Certification</span>
                </div>
                <h3 class="text-lg font-black text-slate-900 mb-2 group-hover:text-indigo-600 transition-colors">{{ formation.titre }}</h3>
                <p class="text-[13px] text-slate-500 line-clamp-2 mb-6 font-medium leading-relaxed">{{ formation.description }}</p>
                <div class="flex items-center gap-4 mb-6">
                    <div class="flex flex-col">
                        <span class="text-[9px] font-bold text-slate-400 uppercase tracking-tighter">Durée</span>
                        <span class="text-xs font-black text-slate-800">{{ formation.dureeHeures }}h</span>
                    </div>
                    <div class="flex flex-col">
                        <span class="text-[9px] font-bold text-slate-400 uppercase tracking-tighter">Niveau</span>
                        <span class="text-xs font-black text-slate-800 capitalize">{{ formation.niveauDifficulte }}</span>
                    </div>
                </div>
                <a href="{{ path('app_formation_show', {'id': formation.id}) }}" class="w-full flex items-center justify-center py-3 bg-slate-900 text-white rounded-xl text-xs font-black hover:bg-brand-600 transition-all shadow-lg shadow-slate-200">
                    Rejoindre
                </a>
            </div>
            {% endfor %}
        </div>
    </div>

    <script>
        function switchDashTab(tabId) {
            // Update tabs
            document.querySelectorAll('.dash-tab').forEach(t => {
                t.classList.remove('active');
                t.classList.remove('text-slate-900');
                t.classList.add('text-slate-500');
            });
            const activeBtn = document.getElementById('tab-' + tabId);
            activeBtn.classList.add('active');
            activeBtn.classList.remove('text-slate-500');
            activeBtn.classList.add('text-slate-900');

            // Update content
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById('content-' + tabId).classList.add('active');
        }
    </script>
{% endblock %}
